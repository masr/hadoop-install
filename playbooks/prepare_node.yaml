- name: create {{ install_base_dir }}
  file: path={{ install_base_dir }} state=directory mode=0755 owner=root group=root
- name: create {{ install_base_dir }}/releases
  file: path={{ install_base_dir }}/releases state=directory mode=0755 owner=root group=root
- name: create {{ install_base_dir }}/releases
  file: path={{ install_base_dir }}/confs state=directory mode=0755 owner=root group=root

- name: add hadoop group
  group: name=hadoop

- name: add hadoop users
  user: name={{ item.name }} groups=hadoop append=yes
  with_items:
    - {name: "zookeeper"}
    - {name: "hdfs"}
    - {name: "yarn"}
    - {name: "mapred"}
    - {name: "hbase"}
    - {name: "spark"}
    - {name: "oozie"}
    - {name: "hive"}

- name: set ulimit
  copy: src=files/limits.conf dest=/etc/security/limits.conf mode=0644 owner=root group=root